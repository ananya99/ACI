# @package _global_

defaults:
  - /example/example

  - /env/agents@env.agents.adversary: object_sphere

  - override /task: navigation
  - override /env/mazes@env.mazes.maze: L
  - override /env/agents@env.agents.goal: object_sphere_light

custom:
  shadow: 0

env:
  renderer:
    scene:
      flags:
        - ${custom.shadow} # mjRND_SHADOW
        - 0 # mjRND_WIREFRAME
        - 0 # mjRND_REFLECTION
        - 0 # mjRND_ADDITIVE
        - 0 # mjRND_SKYBOX
        - 0 # mjRND_FOG
        - 0 # mjRND_HAZE
        - 0 # mjRND_SEGMENT
        - 0 # mjRND_IDCOLOR
        - 1 # mjRND_CULL_FACE

  mazes:
    maze:
      agent_id_map:
        A: ${glob:adversary*,${oc.dict.keys:env.agents}}

  agents:
    agent:
      eyes:
        eye:
          resolution: [20, 20]
          # num_eyes: [1, 3]
          # lon_range: [-30, 30]

          renderer:
            scene:
              flags: ${env.renderer.scene.flags}

    goal:
      custom:
        size: 1.0

      xml:
        overrides:
          - mujoco:
              - worldbody:
                  - body:
                      - name: ${parent:xml}_body
                      - light:
                          - name: ${parent:xml}_light
                          - class: object
                          - dir: 0 -1 -0.05
                          - pos: 0 0 10
                          - directional: "true"
              - asset:
                  - material:
                      - name: ${parent:xml}_mat
                      - rgba: 1.0 1.0 1.0 1.0
                      - emission: 1
                  - material:
                      - name: ${parent:xml}_top_mat
                      - rgba: 0.2 0.8 0.2 1.0
                      - emission: 1
    adversary:
      custom:
        # make the adversary red
        rgba: 0.8 0.2 0.2 1.0

  truncation_fn:
    truncate_if_close_to_adversary:
      _target_: cambrian.envs.done_fns.done_if_close_to_agents
      _partial_: true
      for_agents: ${glob:agent*,${oc.dict.keys:env.agents}}
      to_agents: ${glob:adversary*,${oc.dict.keys:env.agents}}
      distance_threshold: 1.0

    truncate_if_has_contacts:
      _target_: cambrian.envs.done_fns.done_if_has_contacts
      _partial_: true
      for_agents: ${glob:agent*,${oc.dict.keys:env.agents}}
