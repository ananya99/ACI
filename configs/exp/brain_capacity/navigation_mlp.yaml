# @package _global_

defaults:
  - /env/mazes/Y_STATIC@env.mazes.Y_STATIC
  - /env/mazes/X_COMPLEX_STATIC@env.mazes.X_COMPLEX_STATIC

  # Use the maze_exp config as the base
  - /exp/maze_exp

  # Define one animal
  - /env/animals@env.animals.animal_0: ${env/animals}
  - /env/animals/eyes@env.animals.animal_0.eyes.eye: ${env/animals/eyes}
  - override /env/animals: point

  # This is already the default, but make it explicit
  - override /trainer/model/policy_kwargs: mlp

trainer:
  # decrease the number of timesteps to speed up the sweep
  total_timesteps: 300_000

env:
  reward_fn:
    euclidean_delta_from_init:
      _target_: cambrian.envs.reward_fns.euclidean_delta_from_init
      _partial_: true

  animals:
    animal_0:
      # Generate 4 eyes, each with a resolution of 10x10 and a field of view of 25x25
      num_eyes_to_generate: [1, 4]
      eyes:
        eye:
          resolution: [10, 1]
          fov: [25, 25]

hydra:
  sweeper:
    # Define some sweeper parameters to do a grid search over different brain
    # capacities to gauge the effect on performance.
    parametrization:
      trainer.model.policy_kwargs.features_extractor_kwargs.output_dim:
        - 8
        - 16
        - 32
        - 64
        - 128
        - 256
      trainer.model.policy_kwargs.features_extractor_kwargs.image_extractor.architecture:
        - [8, 16]
        - [16, 32]
        - [32, 64]
        - [64, 128]
        - [128, 256]
        - [256, 512]
