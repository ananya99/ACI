# @package _global_

defaults:
  # Use one maze for the time being
  - /env/mazes/SQUARE@env.mazes.SQUARE

  # Use the maze_exp config as the base
  - /exp/maze_exp

  # Define two animals
  # The first will be the "predator" and has a fixed policy that tries to catch the prey
  - /env/animals@env.animals.predator: point_predator
  # The second is the "prey" and is trainable
  - /env/animals@env.animals.prey: point
  - /env/animals/eyes@env.animals.prey.eyes.prey_eye_0: ${env/animals/eyes}
  - /env/animals/eyes@env.animals.prey.eyes.prey_eye_1: ${env/animals/eyes}

trainer:
  total_timesteps: 1_000_000

  wrappers:
    single_animal_env_wrapper:
      animal_name: prey

env:
  # Set the reward fns
  reward_fn:
    euclidean_delta_from_init:
      factor: 0.0
    penalize_if_has_contacts:
      penalty: -0.1
    prey_reward_if_predator_not_in_view:
      _target_: cambrian.envs.reward_fns.reward_if_animals_in_view
      _partial_: true

      # Reward the prey if the predator can't see it
      from_animals: [predator]
      to_animals: [prey]
      for_animals: [prey]
      reward_not_in_view: 0.75

  animals:
    prey:
      eyes:
        prey_eye_0:
          resolution: [20, 20]
          coord: [10, -90]
          fov: [120, 10]
        prey_eye_1:
          resolution: [20, 20]
          coord: [10, 90]
          fov: [120, 10]
