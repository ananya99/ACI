# @package _global_

defaults:
  - /env/agents@env.agents.agent: point
  - /env/agents/eyes@env.agents.agent.eyes.eye: eye

  # Use the maze_exp config as the base
  - /exp/exp

  - /exp/tasks/initial_conditions/simple_flatland

custom:
  agent_hidden: false
  agent_mat_rgba: ${eval:'"0 0 0 0" if ${.agent_hidden} else "0.3 0.6 0.3 1.0"'}
  agent_direction_site_rgba: ${eval:'"0 0 0 0" if ${.agent_hidden} else "1.0 0.0 0.0 1.0"'}
  agent_direction_site_z: 0.0
  agent_pos: "0 0 0.2"

  frustum_hidden: false
  frustum_size: 10.0

  camera_scale: 1.0

  orthographic: true

  headlight_active: false
  headlight_ambient: "0.5 0.5 0.5"

  offwidth: 2560
  offheight: 1920

env:
  # mazes:
  #   maze:
  #     xml:
  #       overrides:
  #         - mujoco:
  #             - asset:
  #                 - material:
  #                     - name: "floor_mat_maze"
  #                     # - rgba: "1 1 1 0.0000000000001"
  agents:
    agent:
      init_quat:
        [
          "${eval:'math.cos(-math.pi/2)'}",
          0,
          0,
          "${eval:'math.sin(-math.pi/2)'}",
        ]

      eyes:
        eye:
          renderer:
            scene:
              mjRND_SKYBOX: 1

      xml:
        overrides:
          - mujoco:
              - asset:
                  - material:
                      - name: "agent_mat"
                      - rgba: "${custom.agent_mat_rgba}"
              - worldbody:
                  - body:
                      - name: "agent_body"
                      - pos: "${custom.agent_pos}"
                      - geom:
                          - name: "agent_geom"
                          - rgba: "0 0 0 0.0000000000001"
                      - site:
                          - name: "agent_direction_site"
                          - size: "0.025 0.10" # R L
                          - pos: "0.25 0 ${custom.agent_direction_site_z}" # 0.2 + L / 2
                          - rgba: "${custom.agent_direction_site_rgba}"

  # Add a nice skybox to the scene; normally the skybox is just black
  xml:
    overrides:
      - mujoco:
          - visual:
              - scale:
                  - camera: "${custom.camera_scale}"
                  - frustum: ${eval:'0.0 if ${custom.frustum_hidden} else ${custom.frustum_size}'}
              - global:
                  - orthographic: ${eval:'"true" if ${custom.orthographic} else "false"'}
                  - fovy: ${eval:'1.5 if ${custom.orthographic} else 45'}
                  - offwidth: ${custom.offwidth}
                  - offheight: ${custom.offheight}
              - headlight:
                  - active: ${eval:'"1" if ${custom.headlight_active} else "0"'}
                  - ambient: ${custom.headlight_ambient}
          - asset:
              - texture:
                  - name: "skybox"
                  - type: "skybox"
                  - builtin: "flat"
                  - width: "512"
                  - height: "512"
                  - rgb1: "1.0 1.0 1.0"
                  - rgb2: "1.0 1.0 1.0"
          # - worldbody:
          #     - light:
          #         - dir: "0 0 -1"
          #         - pos: "5 5 0"
          #         - directional: "true"

  add_overlays: False
  renderer:
    scene:
      mjRND_SKYBOX: 1
