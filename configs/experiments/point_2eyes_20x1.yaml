extend: 
  base: ${extend:${include:configs/base.yaml}}
  experiment: null 

training_config:
  total_timesteps: 1_000_000
  max_episode_steps: 256
  n_steps: 2048

  features_extractor_activation: Tanh

  learning_rate: 0.001
  n_epochs: 8
  gae_lambda: 0.95
  n_envs: 10

env_config:
  
  animal_configs:
    animal_0:
      extend: ${extend:${evo_config.spawning_config.default_animal_config}}
      model_config:
        extend: ${extend:${include:configs/animals/point.yaml}}
      constant_actions: [null, null]
      eye_configs:
        animal_0_eye_0:
          extend: ${extend:${evo_config.spawning_config.default_eye_config}}
          resolution: [20, 1]
          fov: [120, 10]
          scene_resolution: [30, 30]
          sensor_resolution: [23, 23]
          aperture_open: 0.1
          # aperture_open: 1.0
          coord: [10.0, -60.0]
          name: animal_0_eye_0
        animal_0_eye_1:
          extend: ${extend:${evo_config.spawning_config.default_eye_config}}
          resolution: [20, 1]
          fov: [120, 10]
          scene_resolution: [30, 30]
          sensor_resolution: [23, 23]
          aperture_open: 0.1
          # aperture_open: 1.0
          coord: [10.0, 60.0]
          name: animal_0_eye_1
      name: animal_0

  use_ambient_light: True
  ambient_light_intensity: [0.9, 0.9, 0.9]
  use_goal_obs: False
  terminate_at_goal: False
  truncate_on_contact: False
  reward_fn_type: euclidean_delta_from_init
  reward_options:
    gamma: 2.0

  maze_selection_criteria:
    mode: NAMED
    name: Y_COMPLEX_MAZE_OPTION 
    # name: Y_MAZE_OPTION
  maze_configs:
    - Y_COMPLEX_MAZE_OPTION 
    - Y_MAZE_OPTION
  eval_maze_configs:
    - Y_COMPLEX_MAZE_OPTION 
    # - Y_MAZE_OPTION
    - OPTIC_FLOW_STRAIGHT_TEXTURE
    - OPTIC_FLOW_STRAIGHT_VAR_TEXTURE

  maze_configs_store:
    BASE:
      extend: ${extend:${include:configs/mazes/maze.yaml}}
      size_scaling: 4.0
      use_target_light_sources: False
      hide_targets: True
      wall_texture_map:
        L: [vertical_10] #[vertical_20, vertical_40, vertical_60, vertical_80] # left
        R: [vertical_10] #[vertical_20, vertical_40, vertical_60, vertical_80] # right
        K: [vertical_10] #[vertical_20, vertical_40, vertical_60, vertical_80] # key
        E: [vertical_10] #[vertical_20, vertical_40, vertical_60, vertical_80] # end
      map: [] # placeholder


    Y_COMPLEX_MAZE_OPTION: 
      use_target_light_sources: False
      hide_targets: True
      wall_texture_map:
        default: [vertical_10]
      extend: 
        base: ${extend:${include:configs/mazes/dr/Y_COMPLEX_MAZE_OPTION.yaml}}
        ref: ${extend:${...BASE}}

    Y_MAZE_OPTION: 
      use_target_light_sources: False
      hide_targets: True
      extend: 
        base: ${extend:${include:configs/mazes/dr/Y_MAZE_OPTION.yaml}}
        ref: ${extend:${...BASE}}

    OPTIC_FLOW_STRAIGHT_TURN: 
      use_target_light_sources: False
      hide_targets: True
      wall_texture_map:
        default: [vertical_10]
      extend: 
        base: ${extend:${include:configs/mazes/eval/OPTIC_FLOW_STRAIGHT_TURN.yaml}}
        ref: ${extend:${...BASE}}

    OPTIC_FLOW_STRAIGHT_TEXTURE: 
      use_target_light_sources: False
      hide_targets: True
      wall_texture_map:
        # default: [vertical_10]
        L: [vertical_8] #[vertical_20, vertical_40, vertical_60, vertical_80] # left
        R: [vertical_10] #[vertical_20, vertical_40, vertical_60, vertical_80] # right
        K: [vertical_10] #[vertical_20, vertical_40, vertical_60, vertical_80] # key
        E: [vertical_10] #[vertical_20, vertical_40, vertical_60, vertical_80] # end
      extend: 
        base: ${extend:${include:configs/mazes/eval/OPTIC_FLOW_STRAIGHT_TEXTURE.yaml}}
        ref: ${extend:${...BASE}}

    OPTIC_FLOW_STRAIGHT_VAR_TEXTURE: 
      use_target_light_sources: False
      hide_targets: True
      wall_texture_map:
        default: [vertical_10]

      extend: 
        base: ${extend:${include:configs/mazes/eval/OPTIC_FLOW_STRAIGHT_VAR_TEXTURE.yaml}}
        ref: ${extend:${...BASE}}

evo_config:
  max_n_envs: 10
  num_generations: 25
  population_config:
    size: 4
    num_top_performers: 2

  spawning_config:
    init_num_mutations: 1
    num_mutations: 1
    mutation_options: [UPDATE_APERTURE]
    replication_type: MUTATION

    default_animal_config:
      name: ${parent:} # will be replaced with parent key. evaluated after extend.
      use_intensity_obs: False
      use_init_pos_obs: False
      use_current_pos_obs: False
      use_action_obs: True
      n_temporal_obs: 5

      # constant_actions: [0.25, null]
      constant_actions: [null, null]

      disable_intensity_sensor: True

    default_eye_config:
      name: ${parent:} # will be replaced with parent key. evaluated after extend.
      mode: fixed
      # enable_optics: True
      enable_optics: False
      aperture_open: 1.0 
      psf_filter_size: [0, 0]

      resolution: [-1, -1] # Placeholder
      fov: [-1, -1] # Placeholder

      renderer_config:
        render_modes: ["rgb_array"] 
        # render_modes: ["rgb_array", "depth_array"]

        use_shared_context: True
