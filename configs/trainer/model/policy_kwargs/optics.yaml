defaults:
  - combined@_here_
  - /env/animals/eyes/optics/optics@features_extractor_kwargs.image_extractor.config

features_extractor_kwargs:
  output_dim: 64
  image_extractor:
    _target_: cambrian.ml.features_extractors.MjCambrianOpticsFeaturesExtractor
    _partial_: true
    features_dim: ${..output_dim}
    activation: ${..activation}
    config:
      # All defaults are stored at custom.default.*. Grab them here for the defaults.
      # Usually the interpolation ${..resolution}/${..sensorsize} is used, but an eye
      # is not the above config in this case like it is in the animal configs.
      # TODO: how can we grab the resolution/sensor size of the eyes?
      eye_resolution: [5, 5] # ${custom.default.eye.resolution}
      eye_sensorsize: ${custom.default.eye.sensorsize}
    base_feature_extractor:
      _target_: cambrian.ml.features_extractors.MjCambrianMLPExtractor
      _partial_: true
      features_dim: ${..features_dim}
      activation: ${..activation}
      architecture: [16, 32]
