training_config:
  logdir: logs-mujoco/
  exp_name: ${filename:}
  checkpoint_path: null # Will train from scratch if unset
  policy_path: null # Will train from scratch if unset

  total_timesteps: 1_000_000
  max_episode_steps: 256
  n_steps: 2048

  learning_rate: 0.001
  n_epochs: 8
  gae_lambda: 0.95
  batch_size: ${eval:'${.n_steps} * ${.n_envs} // ${.n_epochs}'}
  n_envs: 10

  eval_freq: 10000
  reward_threshold: 90.0
  max_no_improvement_evals: 10 # check_freq * max_no_improvement_evals steps
  min_no_improvement_evals: 10 # check_freq * min_no_improvement_evals steps

  seed: 424242
  verbose: 2

env_config:
  xml: ${include:models/scene.xml,str}
  use_directional_light: False
  use_headlight: False

  reward_fn_type: intensity_and_at_goal

  use_goal_obs: False
  terminate_at_goal: False
  truncate_on_contact: False
  distance_to_target_threshold: 2.0

  frame_skip: 10

  use_renderer: True
  add_overlays: True
  overlay_width: 0.5
  overlay_height: 0.35
  renderer_config:
    extend: ${extend:${include:configs_mujoco/overlays/render_bev.yaml}}

    render_modes: [rgb_array]

    use_shared_context: True

  maze_selection_criteria:
    mode: DIFFICULTY
    schedule: "logistic" 
  maze_configs:
    STRAIGHT_MAZE_DIVERSE:
      extend: ${extend:${include:configs_mujoco/mazes/train/STRAIGHT_MAZE_DIVERSE.yaml}}
    O_MAZE_DIVERSE:
      extend: ${extend:${include:configs_mujoco/mazes/train/O_MAZE_DIVERSE.yaml}}
    G_MAZE_DIVERSE:
      extend: ${extend:${include:configs_mujoco/mazes/train/G_MAZE_DIVERSE.yaml}}
    M_MAZE_DIVERSE:
      extend: ${extend:${include:configs_mujoco/mazes/train/M_MAZE_DIVERSE.yaml}}
    MEDIUM_MAZE_DIVERSE:
      extend: ${extend:${include:configs_mujoco/mazes/train/MEDIUM_MAZE_DIVERSE.yaml}}
    LARGE_MAZE_DIVERSE:
      extend: ${extend:${include:configs_mujoco/mazes/train/LARGE_MAZE_DIVERSE.yaml}}
  eval_maze_configs:
    OPTIC_FLOW_SNAKE_EASY:
      extend: ${extend:${include:configs_mujoco/mazes/eval/OPTIC_FLOW_SNAKE_EASY.yaml}}
    STRAIGHT_MAZE_DIVERSE_eval:
      extend: ${extend:${include:configs_mujoco/mazes/train/STRAIGHT_MAZE_DIVERSE.yaml}}
    O_MAZE_DIVERSE_eval:
      extend: ${extend:${include:configs_mujoco/mazes/train/O_MAZE_DIVERSE.yaml}}
    G_MAZE_DIVERSE_eval:
      extend: ${extend:${include:configs_mujoco/mazes/train/G_MAZE_DIVERSE.yaml}}
    M_MAZE_DIVERSE_eval:
      extend: ${extend:${include:configs_mujoco/mazes/train/M_MAZE_DIVERSE.yaml}}
    MEDIUM_MAZE_DIVERSE_eval:
      extend: ${extend:${include:configs_mujoco/mazes/train/MEDIUM_MAZE_DIVERSE.yaml}}
    LARGE_MAZE_DIVERSE_eval:
      extend: ${extend:${include:configs_mujoco/mazes/train/LARGE_MAZE_DIVERSE.yaml}}

evo_config:
  max_n_envs: 10

  num_generations: 200

  population_config:
    size: 4
    num_top_performers: 2

  spawning_config:
    init_num_mutations: 100
    replication_type: MUTATION

    default_animal_config:
      name: ${parent:} # will be replaced with parent key. evaluated after extend.
      use_qpos_obs: False
      use_qvel_obs: False
      use_intensity_obs: False
      use_action_obs: True
      n_temporal_obs: 10

      mutation_options: [ADD_EYE, REMOVE_EYE, EDIT_EYE]

      disable_intensity_sensor: False
      intensity_sensor_config:
        mode: fixed
        resolution: [1, 1]
        fov: [120, 10]
        filter_size: [0, 0]

        renderer_config:
          render_modes: [rgb_array]

          use_shared_context: True

    default_eye_config:
      name: ${parent:} # will be replaced with parent key. evaluated after extend.
      mode: fixed
      filter_size: [0, 0]

      resolution: [-1, -1] # Placeholder
      fov: [-1, -1] # Placeholder

      renderer_config:
        render_modes: [rgb_array]

        use_shared_context: True

  environment_variables: {}
